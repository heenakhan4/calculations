--This is the version 3 logic--
