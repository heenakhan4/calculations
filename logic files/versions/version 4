--This is the version 4 logic--
